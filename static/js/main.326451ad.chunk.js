(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{120:function(e,t,a){e.exports=a(193)},126:function(e,t,a){},131:function(e,t,a){},134:function(e,t,a){},193:function(e,t,a){"use strict";a.r(t);var n=a(1),o=a.n(n),r=a(3),c=a.n(r),l=(a(125),a(126),a(55)),u=a(56),i=a(67),s=a(58),d=a(66),p=a(64),f=a(200),m=(a(131),a(33)),v=a(105),h=a(106),k=a(107);var g=Object(m.c)({app:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return arguments.length>1&&arguments[1],e}}),y=Object(k.createLogger)(),S=Object(h.routerMiddleware)(M),E=Object(m.d)(g,Object(m.a)(v.a,S,y)),C=a(43),M=Object(C.a)(),O=a(199),x=a(201),b=a(198),F=a(117),w=a(48),I=a(108),N=a.n(I),_=a(197),T=a(196),j=a(195),P=a(194),z=a(8),A=a(202);a(134);function K(e){var t=e.fuckt,a=e.onFucktChange,n=e.onCloseClick,r=e.zoomOut;return o.a.createElement("div",{className:"paper",style:{zoom:100-r+"%",outline:t.selected?"dashed 1px cornflowerblue":"none"}},o.a.createElement("div",{className:"paper__drag-place"}),o.a.createElement("div",{className:"paper-content"},o.a.createElement("textarea",{autoFocus:!0,value:t.text,onChange:function(e){var n=e.target.value;return a(n,t)}})),o.a.createElement(z.a,{className:"paper__close",type:"close",onClick:function(){return n(t)}}))}var U=a(22),D={zoom:{display:"flex",flexDirection:"column",height:75,justifyContent:"space-evenly",alignItems:"center"}};function V(e){var t=e.onPlus,a=e.onMinus;return o.a.createElement("div",{className:"zoom",style:D.zoom},o.a.createElement(U.a,{shape:"circle",icon:"plus",onClick:function(){return t()}}),o.a.createElement(U.a,{shape:"circle",icon:"minus",onClick:function(){return a()}}))}V.defaultProps={onPlus:function(){},onMinus:function(){}};var J=V,Y={layout:{background:"#E5F7FF"},content:{wrapper:{padding:"5px 5px 10px"},div:{padding:10,minHeight:280,height:"calc(100vh - 60px)",borderRadius:"3px",background:"#E5F7FF",position:"relative"}},draggable:{wrapper:{display:"inline-block",position:"absolute"}},zoom:{transition:"all 0.2s",position:"fixed",bottom:10,left:90},notCollapsedZoom:{left:210}},Z=_.a.Content,B=_.a.Sider,L=T.a.confirm,W=j.a.Search,H=(P.a.SubMenu,1),R=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(w.a)({},t,{text:e,id:Date.now()+H++})},$=[R("\u041a\u043b\u0438\u043a\u043d\u0438 \u043d\u0430 \u043c\u0435\u043d\u044f!",{defaultPosition:{x:400,y:70}}),R("\u041f\u0440\u0438\u0432\u0435\u0442, \u0434\u043e\u0431\u0430\u0432\u044c \u043f\u0430\u0440\u0443 \u0444\u0430\u043a\u0442\u043e\u0432 \u043e \u0441\u0435\u0431\u0435!",{defaultPosition:{x:100,y:100}}),R("\u0422\u044b \u043c\u043e\u0436\u0435\u0448\u044c \u0434\u0432\u0438\u0433\u0430\u0442\u044c \u043d\u0430\u0441 \u043a\u0430\u043a \u0437\u0430\u0445\u043e\u0447\u0435\u0448\u044c!",{defaultPosition:{x:305,y:130}}),R("\u041f\u043e\u0442\u044f\u043d\u0438 \u043c\u044b\u0448\u043a\u043e\u0439 \u0437\u0430 \u043a\u0440\u0430\u0439 \u043b\u0438\u0441\u0442\u043e\u0447\u043a\u0430!",{defaultPosition:{x:150,y:225}})],q=function(e){function t(){var e,a;Object(l.a)(this,t);for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];return(a=Object(i.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(o)))).state={fuckts:$,fucktValue:"",collapsed:!0,currentMapIndex:1,zoomOut:0},a.onCollapse=function(e){console.log(e),a.setState({collapsed:e})},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.fuckts,n=t.fucktValue,r=t.collapsed,c=t.saveMapModalIsVisible,l=t.mapSaveName,u=t.successTextAlert,i=t.allFucktMaps,s=t.currentMapIndex,d=t.zoomOut;return o.a.createElement(_.a,{className:"layout pov-page",style:Y.layout},o.a.createElement(B,{collapsible:!0,collapsed:r,onCollapse:this.onCollapse},o.a.createElement("div",{className:"logo"}),o.a.createElement(P.a,{theme:"dark",selectedKeys:["".concat(s)],mode:"inline"},o.a.createElement(P.a.Item,{key:"1",onClick:function(){return e.goToNew()}},o.a.createElement(z.a,{type:"file"}),o.a.createElement("span",null,"\u041d\u043e\u0432\u0430\u044f \u043a\u0430\u0440\u0442\u0430")),o.a.createElement(P.a.Item,{key:"2",onClick:function(){return e.triggerSaveMap()}},o.a.createElement(z.a,{type:"save"}),o.a.createElement("span",null,"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c \u043a\u0430\u0440\u0442\u0443")),i.map(function(t,a){return o.a.createElement(P.a.Item,{key:a+3,onClick:function(){return e.goToMap(t.mapSaveNameFormatted,a+3)}},o.a.createElement(z.a,{type:"copy"}),o.a.createElement("span",null,t.name))}),o.a.createElement(P.a.Item,{key:"1000",onClick:function(){return e.triggerDeleteMap()}},o.a.createElement(z.a,{type:"delete"}),o.a.createElement("span",null,"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u043a\u0430\u0440\u0442\u0443")))),o.a.createElement(Z,{style:Y.content.wrapper},o.a.createElement(W,{className:"pov-page__create-input",placeholder:"\u0412\u0432\u0435\u0434\u0438 \u0441\u0432\u043e\u0439 \u0444\u0430\u043a\u0442",enterButton:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c",size:"large",value:n,onChange:function(t){var a=t.target.value;return e.handleUpdateFucktValue(a)},onSearch:function(t){return e.handleCreateFuckt(t)}}),o.a.createElement("div",{className:"draggable-area",style:Y.content.div,onKeyDown:function(t){return e.handleAreaKeyDown(t)}},a.map(function(t,a){return o.a.createElement(N.a,{key:t.id,bounds:".draggable-area",handle:".paper__drag-place",defaultPosition:t.defaultPosition,onStart:function(t){return e.handleUpdateFucktCoordsFromStart(t)},onStop:function(a){return e.handleUpdateFucktCoords(a,t)}},o.a.createElement("div",{style:Object(w.a)({},Y.draggable.wrapper,{zIndex:t.zIndex,opacity:t.deleted?0:1,pointerEvents:t.deleted?"none":"auto"}),onClick:function(){return e.handleClickDragFuckt(t)}},o.a.createElement(K,{zoomOut:d,fuckt:t,onFucktChange:function(t,a){return e.handleCahngeFuckt(t,a)},onCloseClick:function(t){return e.handleCloseFuckt(t)}})))}))),o.a.createElement(T.a,{title:"\u041d\u0430\u0437\u043e\u0432\u0438 \u0441\u0432\u043e\u044e \u0444\u0430\u043a\u0442-\u043a\u0430\u0440\u0442\u0443",visible:c,onOk:function(){return e.handleSaveMapOk()},onCancel:function(){return e.toggleSaveMap()},okText:"\u0412\u043e\u0442 \u0442\u0430\u043a",cancelText:"\u041f\u043e\u0442\u043e\u043c, \u043e\u0442\u0441\u0442\u0430\u043d\u044c!"},o.a.createElement(j.a,{placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0441\u044e\u0434\u0430",value:l,onChange:function(t){var a=t.target.value;return e.setState(function(){return{mapSaveName:a}})}})),u&&o.a.createElement("div",null,o.a.createElement(A.a,{message:u,type:"success",showIcon:!0,afterClose:function(){return e.setState(function(){return{successTextAlert:""}})}})),o.a.createElement("span",{style:Object(w.a)({},Y.zoom,r?{}:Y.notCollapsedZoom)},o.a.createElement(J,{onPlus:function(){return e.handleZoom(-10)},onMinus:function(){return e.handleZoom(10)}})))}},{key:"handleAreaKeyDown",value:function(e){var t=String.fromCharCode(e.which).toLowerCase();if((e.ctrlKey||e.metaKey)&&"c"===t){var a=this.state.fuckts,n=a.find(function(e){return e.selected});n&&!n.deleted&&(a.push(R(n.text,Object(w.a)({},n,{defaultPosition:{x:30,y:30}}))),this.setState(function(){return{fuckts:a}}))}}},{key:"handleZoom",value:function(e){var t=this.state.zoomOut;(t+=e)>50&&(t=50),t<0&&(t=0),this.setState(function(){return{zoomOut:t}})}},{key:"goToNew",value:function(){this.setState(function(){return{fuckts:$,currentMapIndex:1}}),M.replace("/fuckts/new")}},{key:"goToMap",value:function(e,t){this.setState(function(){return{currentMapIndex:t}}),M.replace("/fuckts/".concat(e))}},{key:"handleUpdateFucktValue",value:function(e){this.setState(function(){return{fucktValue:e}})}},{key:"handleCreateFuckt",value:function(e){var t=this.state.fuckts;t.push(R(e)),this.setState(function(){return{fuckts:t,fucktValue:""}})}},{key:"handleCahngeFuckt",value:function(e,t){var a=this.state.fuckts,n=a.findIndex(function(e){return e.id===t.id});a[n].text=e,this.setState(function(){return{fuckts:a}})}},{key:"handleCloseFuckt",value:function(e){var t=this.state.fuckts,a=t.findIndex(function(t){return t.id===e.id});t[a].deleted=!0,this.setState(function(){return{fuckts:t}})}},{key:"handleClickDragFuckt",value:function(e){var t=this.selectFuckt(e).fuckts,a=t.findIndex(function(t){return t.id===e.id});t[a].zIndex=Math.max.apply(null,t.map(function(e){return e.zIndex||0}))+1,this.setState(function(){return{fuckts:t}})}},{key:"selectFuckt",value:function(e){var t=this.state.fuckts;return t.map(function(t){t.selected=t.id===e.id}),{fuckts:t}}},{key:"handleUpdateFucktCoordsFromStart",value:function(e){this.movedFuckt=e.currentTarget}},{key:"handleUpdateFucktCoords",value:function(e,t){var a=Object(r.findDOMNode)(this.movedFuckt);if(a){var n=a.style.transform.replace("translate(","").replace(")","").replace("px,","").replace("px","").split(" "),o=Object(F.a)(n,2),c=o[0],l=o[1],u=this.state.fuckts,i=u.findIndex(function(e){return e.id===t.id});u[i].pos={x:+c,y:+l},this.setState(function(){return{fuckts:u}})}}},{key:"triggerDeleteMap",value:function(){var e=this,t=this.props.match,a=(t=void 0===t?{}:t).params,n=(a=void 0===a?{}:a).pov;if("new"!==n){var o=JSON.parse(localStorage.getItem("".concat("FUCKT_MAP_KEY_").concat(n))||"{}");L({title:"\u0425\u043e\u0447\u0435\u0448\u044c \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043a\u0430\u0440\u0442\u0443 '".concat(o.name,"'?"),content:"\u0415\u0451 \u0431\u043e\u043b\u044c\u0448\u0435 \u043d\u0435\u043b\u044c\u0437\u044f \u0431\u0443\u0434\u0435\u0442 \u0432\u043e\u0441\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c",okText:"\u0414\u0430, \u0434\u0430\u0432\u0430\u0439",okType:"danger",cancelText:"\u041e\u0439, \u043d\u0435\u0442!",onOk:function(){var t=JSON.parse(localStorage.getItem("FUCKT_MAP_NAMES")||"[]"),a=t.indexOf(n);t.splice(a,1),localStorage.setItem("FUCKT_MAP_NAMES",JSON.stringify(t)),localStorage.setItem("".concat("FUCKT_MAP_KEY_").concat(n),""),e.goToNew()}})}}},{key:"triggerSaveMap",value:function(){var e=this.props.match,t=(e=void 0===e?{}:e).params,a=(t=void 0===t?{}:t).pov;if("new"!==a)return this.handleSaveMapOk(a);this.setState(function(){return{saveMapModalIsVisible:!0}})}},{key:"toggleSaveMap",value:function(){var e=this.state.saveMapModalIsVisible;this.setState(function(){return{saveMapModalIsVisible:!e}})}},{key:"handleSaveMapOk",value:function(e){var t=this,a=this.state,n=a.mapSaveName,o=void 0===n?e:n,r=a.fuckts,c=a.zoomOut,l=o.replace(/\s/g,"_"),u=JSON.parse(localStorage.getItem("FUCKT_MAP_NAMES")||"[]");-1===u.indexOf(l)&&u.push(l),localStorage.setItem("FUCKT_MAP_NAMES",JSON.stringify(u)),localStorage.setItem("".concat("FUCKT_MAP_KEY_").concat(l),JSON.stringify({id:Date.now()+H++,name:o,mapSaveNameFormatted:l,fuckts:r,zoomOut:c})),this.setState(function(){return{mapSaveName:void 0,saveMapModalIsVisible:!1,successTextAlert:"\u041a\u0430\u0440\u0442\u0430 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0430"}}),setTimeout(function(){return t.setState(function(){return{successTextAlert:""}})},5e3),e||M.replace("/fuckts/".concat(l))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var a=e.match,n=(a=void 0===a?{}:a).params,o=(n=void 0===n?{}:n).pov;if(t.saveMapModalIsVisible)return null;var r=JSON.parse(localStorage.getItem("FUCKT_MAP_NAMES")||"[]").map(function(e){return JSON.parse(localStorage.getItem("".concat("FUCKT_MAP_KEY_").concat(e))||"{}")});if("new"===o&&"new"!==t.pov)return{pov:o,zoomOut:0,fuckts:$.map(function(e){return e.id=Date.now()+H++,e}),allFucktMaps:r};if(t.pov!==o){var c=JSON.parse(localStorage.getItem("".concat("FUCKT_MAP_KEY_").concat(o))||"{}"),l=c.fuckts,u=c.zoomOut,i=void 0===u?0:u,s=r.findIndex(function(e){return e.id===c.id})+3;return{pov:o,zoomOut:i,allFucktMaps:r,currentMapIndex:s,fuckts:l&&l.length?l.map(function(e){return e.defaultPosition=e.pos,e}):[]}}return null}}]),t}(o.a.Component),G=function(){return o.a.createElement(O.a,null,o.a.createElement(x.a,{path:"/fuckts/:pov",component:q}),o.a.createElement(b.a,{from:"/",to:"/fuckts/new"}),o.a.createElement(b.a,{from:"*",to:"/"}))},Q=function(e){function t(e){var a;return Object(l.a)(this,t),a=Object(i.a)(this,Object(s.a)(t).call(this,e)),M.listen(function(e,t){console.log(e)}),a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return o.a.createElement("div",{className:"app"},o.a.createElement(f.a,{history:M},o.a.createElement(G,null)))}}]),t}(n.Component),X=Object(p.b)()(Q);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(p.a,{store:E},o.a.createElement(X,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[120,1,2]]]);
//# sourceMappingURL=main.326451ad.chunk.js.map